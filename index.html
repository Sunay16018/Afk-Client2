<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTIMATE ENGINE - GOD MODE</title>
    <style>
        :root { --bg: #050505; --card: #0f0f0f; --border: #222; --accent: #00ff88; --red: #ff3333; }
        body { background: var(--bg); color: #eee; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 15px; display: flex; flex-direction: column; height: 100vh; box-sizing: border-box; }
        
        .grid { display: grid; grid-template-columns: 300px 1fr 300px; gap: 15px; height: 100%; }
        .box { background: var(--card); border: 1px solid var(--border); border-radius: 8px; display: flex; flex-direction: column; overflow: hidden; }
        .header { background: #1a1a1a; padding: 10px; font-size: 12px; font-weight: bold; color: var(--accent); text-transform: uppercase; border-bottom: 1px solid var(--border); }
        
        input, select, button { background: #151515; border: 1px solid var(--border); color: #fff; padding: 10px; margin-bottom: 8px; border-radius: 4px; font-size: 13px; }
        button { cursor: pointer; background: var(--accent); color: #000; font-weight: bold; border: none; }
        button:hover { opacity: 0.8; }

        #logbox { flex: 1; overflow-y: auto; padding: 10px; font-family: 'Consolas', monospace; font-size: 12px; background: #000; }
        
        /* BOT LISTESI VE 6px KES BUTONU */
        .bot-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid var(--border); cursor: pointer; }
        .bot-item.active { background: #1a1a1a; border-left: 3px solid var(--accent); }
        .kes-btn { 
            width: 16px; height: 16px; /* Görünürlük için çerçeve */
            padding: 6px; /* İstenen 6px 6px iç alan etkisi */
            background: var(--red); color: white; border: none; border-radius: 2px;
            font-size: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer;
        }

        .stats { padding: 10px; display: flex; justify-content: space-between; font-size: 14px; font-weight: bold; }
        .ctrl-btns { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; padding: 10px; }
        .ctrl-btns button { margin: 0; padding: 15px; background: #222; color: #fff; border: 1px solid #333; }
        .ctrl-btns button.active { background: var(--accent); color: #000; }

        .inv-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 4px; padding: 10px; }
        .slot { background: #1a1a1a; border: 1px solid #333; aspect-ratio: 1; display: flex; align-items: center; justify-content: center; position: relative; font-size: 10px; }
    </style>
</head>
<body>

<div class="grid">
    <div class="box">
        <div class="header">SİSTEME GİRİŞ</div>
        <div style="padding: 15px; display: flex; flex-direction: column;">
            <input id="host" placeholder="Sunucu IP">
            <input id="user" placeholder="Bot İsmi">
            <select id="ver">
                <option value="1.20.1">1.20.1</option>
                <option value="1.19.4">1.19.4</option>
                <option value="1.16.5">1.16.5</option>
                <option value="1.8.9">1.8.9</option>
            </select>
            <button onclick="connect()">BAĞLAN</button>
            <div id="botList" style="margin-top: 15px;"></div>
        </div>
    </div>

    <div class="box">
        <div class="header">KOMUT SATIRI VE LOGLAR</div>
        <div id="logbox"></div>
        <div style="padding: 10px; display: flex; gap: 5px;">
            <input id="chatMsg" placeholder="Mesaj yaz..." style="flex: 1; margin: 0;">
            <button onclick="sendChat()" style="width: 80px;">GÖNDER</button>
        </div>
    </div>

    <div class="box">
        <div class="header">DURUM VE KONTROL</div>
        <div class="stats">
            <span style="color: #ff4d4d;">HP: <span id="hp">--</span></span>
            <span style="color: #ffa500;">AÇLIK: <span id="food">--</span></span>
        </div>
        <div class="ctrl-btns">
            <div></div><button onmousedown="move('forward', true)" onmouseup="move('forward', false)">W</button><div></div>
            <button onmousedown="move('left', true)" onmouseup="move('left', false)">A</button>
            <button onmousedown="move('back', true)" onmouseup="move('back', false)">S</button>
            <button onmousedown="move('right', true)" onmouseup="move('right', false)">D</button>
            <button onclick="move('jump', true); setTimeout(()=>move('jump',false), 200)">Zıpla</button>
        </div>
        <div class="header">ENVANTER</div>
        <div class="inv-grid" id="inv"></div>
    </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    let selectedBot = "";

    function connect() {
        const host = document.getElementById('host').value;
        const user = document.getElementById('user').value;
        const ver = document.getElementById('ver').value;
        if(host && user) socket.emit('start_bot', { host, user, ver });
    }

    socket.on('update_list', (list) => {
        const container = document.getElementById('botList');
        container.innerHTML = list.map(u => `
            <div class="bot-item ${u === selectedBot ? 'active' : ''}" onclick="selectBot('${u}')">
                <span>${u}</span>
                <button class="kes-btn" onclick="socket.emit('stop_bot', '${u}')">X</button>
            </div>
        `).join('');
    });

    socket.on('bot_log', (data) => {
        if(data.user === selectedBot) {
            const lb = document.getElementById('logbox');
            lb.innerHTML += data.html;
            lb.scrollTop = lb.scrollHeight;
        }
    });

    socket.on('bot_data', (allData) => {
        if(selectedBot && allData[selectedBot]) {
            const d = allData[selectedBot];
            document.getElementById('hp').innerText = Math.round(d.hp);
            document.getElementById('food').innerText = Math.round(d.food);
            
            const invHtml = d.inv.map(i => `<div class="slot" title="${i.name}"><span>${i.count}</span></div>`).join('');
            document.getElementById('inv').innerHTML = invHtml;
        }
    });

    function selectBot(u) {
        selectedBot = u;
        document.getElementById('logbox').innerHTML = ""; // Yeni botun logları için temizle
        socket.emit('update_list', []); // Görsel güncelleme tetikle
    }

    function sendChat() {
        const msg = document.getElementById('chatMsg').value;
        if(selectedBot && msg) {
            socket.emit('send_chat', { user: selectedBot, msg });
            document.getElementById('chatMsg').value = "";
        }
    }

    function move(dir, state) {
        if(selectedBot) socket.emit('move_bot', { user: selectedBot, dir, state });
    }
</script>
</body>
</html>
