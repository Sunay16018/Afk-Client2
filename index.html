<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ultimate Bot Panel v13</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --border: #30363d; --act: #2ecc71; --blue: #58a6ff; --red: #da3633; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: #c9d1d9; font-family: -apple-system, system-ui, sans-serif; margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        nav { display: flex; background: var(--card); border-bottom: 1px solid var(--border); flex-shrink: 0; }
        nav button { flex: 1; padding: 15px 5px; border: none; background: none; color: #8b949e; font-weight: bold; font-size: 11px; cursor: pointer; text-transform: uppercase; }
        nav button.active { color: var(--blue); border-bottom: 2px solid var(--blue); background: #1c2128; }

        .tab { flex: 1; display: none; padding: 12px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .active-tab { display: block; }

        #logbox { background: #000; height: 55vh; overflow-y: auto; padding: 10px; font-size: 12px; border-radius: 8px; border: 1px solid var(--border); margin-bottom: 10px; line-height: 1.5; font-family: 'Consolas', monospace; word-break: break-all; }
        
        input, select { background: var(--bg); border: 1px solid var(--border); color: #fff; padding: 12px; border-radius: 8px; width: 100%; margin-bottom: 8px; font-size: 16px; outline: none; }
        .btn { background: #238636; color: #fff; border: none; padding: 15px; width: 100%; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.2); }
        
        .m-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; max-width: 180px; margin: 15px auto; }
        .m-btn { aspect-ratio: 1; background: var(--card); border: 1px solid var(--border); color: white; border-radius: 12px; font-weight: bold; font-size: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        .m-btn.on { background: var(--act); color: #000; border-color: #fff; }

        .inv-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 6px; }
        .slot { background: #1c2128; border: 1px solid #444c56; aspect-ratio: 1; border-radius: 6px; display: flex; align-items: center; justify-content: center; position: relative; }
        .slot img { width: 80%; }
        .count { position: absolute; bottom: 1px; right: 2px; font-size: 10px; font-weight: bold; color: #fff; text-shadow: 1px 1px 0 #000; }

        .bot-list-item { display: flex; justify-content: space-between; align-items: center; background: var(--card); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 1px solid var(--border); }
    </style>
</head>
<body>

<nav>
    <button onclick="T('bot')" id="n-bot" class="active">BAÄžLANTI</button>
    <button onclick="T('chat')" id="n-chat">CHAT/GECE</button>
    <button onclick="T('ctrl')" id="n-ctrl">KONTROL</button>
    <button onclick="T('inv')" id="n-inv">Ã‡ANTA</button>
</nav>

<div id="t-bot" class="tab active-tab">
    <input id="host" placeholder="Sunucu IP">
    <input id="user" placeholder="Bot Ä°smi">
    <select id="ver">
        <option value="1.20.1">1.20.1</option>
        <option value="1.8.9">1.8.9</option>
        <option value="1.21.1">1.21.1</option>
    </select>
    <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px; background:var(--card); padding:12px; border-radius:8px;">
        <span style="flex:1; font-size:14px; color:#8b949e;">Oto-BaÄŸlan (Proxy Koruma)</span>
        <input type="checkbox" id="ar" checked style="width:22px; height:22px;">
    </div>
    <button class="btn" onclick="start()">SÄ°STEMÄ° BAÅžLAT</button>
    <div id="blist" style="margin-top:20px"></div>
</div>

<div id="t-chat" class="tab">
    <div id="logbox"></div>
    <div style="display:flex; gap:8px;">
        <input id="mi" placeholder="Mesaj veya /goto x y z" onkeydown="if(event.key==='Enter') send()" style="margin:0;">
        <button onclick="send()" style="background:var(--blue); border:none; color:white; border-radius:8px; width:60px; font-size:18px;">âž¤</button>
    </div>
</div>

<div id="t-ctrl" class="tab">
    <div id="stat" style="text-align:center; font-weight:bold; color:var(--act); margin-bottom:15px; font-size:16px;"></div>
    <div class="m-grid">
        <div></div><button class="m-btn" id="b-forward" onclick="M('forward')">W</button><div></div>
        <button class="m-btn" id="b-left" onclick="M('left')">A</button>
        <button class="m-btn" id="b-jump" onclick="M('jump')">Z</button>
        <button class="m-btn" id="b-right" onclick="M('right')">D</button>
        <div></div><button class="m-btn" id="b-back" onclick="M('back')">S</button><div></div>
    </div>
    <p style="text-align:center; font-size:11px; color:#8b949e; line-height:1.4;">Z butonu zÄ±platÄ±r. Arka planda "Ä°nsansÄ± AFK" (bakÄ±ÅŸ ve rastgele zÄ±plama) adminlere karÅŸÄ± botu korur.</p>
</div>

<div id="t-inv" class="tab">
    <div class="inv-grid" id="inv-display"></div>
    <p style="text-align:center; font-size:12px; color:#8b949e; margin-top:20px;">EÅŸyaya dokunursan o slottaki her ÅŸeyi yere atar.</p>
</div>

<script>
    let sid = localStorage.getItem('bot_sid') || 's_'+Math.random().toString(36).substr(2,9);
    localStorage.setItem('bot_sid', sid);
    let sel = "", moves = {}, lastLogLen = 0;

    function T(t){
        document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active-tab'));
        document.querySelectorAll('nav button').forEach(x=>x.classList.remove('active'));
        document.getElementById('t-'+t).classList.add('active-tab');
        document.getElementById('n-'+t).classList.add('active');
    }

    async function start(){
        const h=document.getElementById('host').value, u=document.getElementById('user').value, 
              v=document.getElementById('ver').value, a=document.getElementById('ar').checked;
        if(!h || !u) return;
        await fetch(`/start?sid=${sid}&host=${h}&user=${u}&ver=${v}&auto=${a}`);
        sel = u; T('chat');
    }

    async function send(){
        const i=document.getElementById('mi');
        if(!i.value || !sel) return;
        await fetch(`/send?sid=${sid}&user=${sel}&msg=${encodeURIComponent(i.value)}`);
        i.value="";
    }

    async function M(d) {
        if(!sel) return;
        moves[d] = !moves[d];
        document.getElementById('b-'+d).classList.toggle('on', moves[d]);
        await fetch(`/move?sid=${sid}&user=${sel}&dir=${d}&state=${moves[d]}`);
    }

    setInterval(async ()=>{
        try {
            const r = await fetch(`/data?sid=${sid}&user=${sel}`);
            const d = await r.json();
            
            document.getElementById('blist').innerHTML = d.active.map(n=>`
                <div class="bot-list-item" style="border-color:${sel==n? 'var(--blue)':'var(--border)'}" onclick="sel='${n}'">
                    <span><b>${n}</b></span>
                    <button onclick="event.stopPropagation(); fetch('/stop?sid=${sid}&user=${n}')" style="background:var(--red); color:white; border:none; border-radius:6px; padding:6px 12px; font-size:11px; font-weight:bold;">DURDUR</button>
                </div>
            `).join('');

            if(sel && d.logs[sel]) {
                const lb = document.getElementById('logbox');
                if(d.logs[sel].length !== lastLogLen) {
                    lb.innerHTML = d.logs[sel].join('<br>');
                    lb.scrollTop = lb.scrollHeight;
                    lastLogLen = d.logs[sel].length;
                }
                if(d.botData){
                    const bd = d.botData;
                    document.getElementById('stat').innerText = `â¤ CAN: %${Math.round(bd.hp*5)} | ðŸ– AÃ‡LIK: ${Math.round(bd.food)}`;
                    document.getElementById('inv-display').innerHTML = bd.inv.map(i=>`
                        <div class="slot" onclick="fetch('/drop?sid=${sid}&user=${sel}&slot=${i.slot}')">
                            <img src="https://raw.githubusercontent.com/PrismarineJS/minecraft-assets/master/data/1.16.1/items/${i.name}.png" onerror="this.src='https://via.placeholder.com/32?text=?'">
                            <span class="count">${i.count}</span>
                        </div>
                    `).join('');
                }
            }
        } catch(e){}
    }, 1500);
</script>
</body>
</html>
