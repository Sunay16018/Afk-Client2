<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite AFK v6</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --border: #30363d; --active: #2ecc71; --blue: #58a6ff; }
        body { background: var(--bg); color: #c9d1d9; font-family: sans-serif; margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        nav { display: flex; background: var(--card); border-bottom: 1px solid var(--border); }
        nav button { flex: 1; padding: 15px; border: none; background: none; color: #8b949e; cursor: pointer; font-weight: bold; }
        nav button.active { color: var(--blue); border-bottom: 3px solid var(--blue); }
        .tab-content { flex: 1; display: none; flex-direction: column; padding: 15px; overflow-y: auto; }
        .active-tab { display: flex; }
        #logbox { flex: 1; background: #000; border: 1px solid var(--border); border-radius: 8px; padding: 10px; font-family: monospace; overflow-y: auto; margin-bottom: 10px; line-height: 1.5; }
        input, select { background: var(--bg); border: 1px solid var(--border); color: white; padding: 12px; border-radius: 8px; margin-bottom: 10px; width: 100%; }
        .btn-p { background: #238636; color: white; padding: 15px; border: none; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; }
        .row { background: var(--card); padding: 12px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid var(--border); }
    </style>
</head>
<body>

<nav>
    <button onclick="T('bots')" id="n-bots" class="active">BOTLAR</button>
    <button onclick="T('chat')" id="n-chat">CHAT</button>
    <button onclick="T('spam')" id="n-spam">SPAM</button>
</nav>

<div id="t-bots" class="tab-content active-tab">
    <div style="display:flex; gap:5px"><input id="host" placeholder="IP"><input id="port" placeholder="25565" style="width:100px"></div>
    <input id="user" placeholder="Kullanıcı Adı">
    <select id="ver"><option value="1.21.1">1.21.1</option><option value="1.20.1">1.20.1</option><option value="1.8.9">1.8.9</option></select>
    <div class="row"><span>Oto-Yeniden Bağlan</span><input type="checkbox" id="ar" style="width:20px; height:20px;"></div>
    <button class="btn-p" onclick="connect()">SİSTEMİ BAŞLAT</button>
    <div id="blist" style="margin-top:15px"></div>
</div>

<div id="t-chat" class="tab-content">
    <div id="logbox"></div>
    <div style="display:flex; gap:5px"><input id="mi" placeholder="Mesaj..."><button class="btn-p" style="width:80px" onclick="sendM()">GÖNDER</button></div>
</div>

<div id="t-spam" class="tab-content">
    <div class="row"><b>SPAM AKTİF</b><input type="checkbox" id="so" onchange="SpT(this.checked)" style="width:20px; height:20px;"></div>
    <input id="sm" placeholder="Mesaj">
    <input id="sd" type="number" value="5" min="1">
    <button class="btn-p" onclick="SpA()">EKLE</button>
    <div id="slist" style="margin-top:15px"></div>
</div>

<script>
    const sid = localStorage.getItem('sid') || 's_'+Math.random().toString(36).substr(2,9);
    localStorage.setItem('sid', sid);
    let sel = "";

    function T(n) {
        document.querySelectorAll('.tab-content').forEach(x => x.classList.remove('active-tab'));
        document.querySelectorAll('nav button').forEach(x => x.classList.remove('active'));
        document.getElementById('t-'+n).classList.add('active-tab');
        document.getElementById('n-'+n).classList.add('active');
    }

    async function connect() {
        const h=document.getElementById('host').value, p=document.getElementById('port').value, 
              u=document.getElementById('user').value, v=document.getElementById('ver').value, a=document.getElementById('ar').checked;
        if(!h || !u) return;
        await fetch(`/start?sid=${sid}&host=${h}&port=${p}&user=${u}&ver=${v}&auto=${a}`);
        sel = u; T('chat');
    }

    async function sendM() {
        const i=document.getElementById('mi');
        if(!sel || !i.value) return;
        await fetch(`/send?sid=${sid}&user=${sel}&msg=${encodeURIComponent(i.value)}`);
        i.value = "";
    }

    async function SpT(s) { if(!sel) return; await fetch(`/togglespam?sid=${sid}&user=${sel}&state=${s}`); }
    async function SpA() {
        const m=document.getElementById('sm').value, d=document.getElementById('sd').value;
        if(!sel || !m) return;
        await fetch(`/addspam?sid=${sid}&user=${sel}&msg=${encodeURIComponent(m)}&delay=${d}`);
    }

    setInterval(async () => {
        try {
            const r = await fetch(`/data?sid=${sid}&user=${sel}`);
            const d = await r.json();
            document.getElementById('blist').innerHTML = d.active.map(n => `<div class="row" style="border-color:${sel==n? 'var(--active)':'var(--border)'}" onclick="sel='${n}'"><span>${n}</span></div>`).join('');
            if(sel && d.logs[sel]) {
                const lb = document.getElementById('logbox'); 
                lb.innerHTML = d.logs[sel].join('<br>'); 
                lb.scrollTop = lb.scrollHeight;
            }
        } catch(e) {}
    }, 1000);
</script>
</body>
</html>
