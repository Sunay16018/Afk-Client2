<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AFK CLIENT</title>
    <style>
        :root { --bg: #0d1117; --panel: #161b22; --border: #30363d; --blue: #58a6ff; --red: #da3633; --green: #238636; }
        body { background: var(--bg); color: #c9d1d9; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        nav { display: flex; background: var(--panel); border-bottom: 1px solid var(--border); height: 50px; flex-shrink: 0; }
        nav button { flex: 1; border: none; background: none; color: #8b949e; font-weight: bold; cursor: pointer; }
        nav button.active { color: var(--blue); border-bottom: 3px solid var(--blue); background: #1f242c; }
        .tab { flex: 1; display: none; padding: 15px; overflow-y: auto; }
        .active-tab { display: block; }
        #logbox { background: #000; height: 50vh; overflow-y: auto; padding: 10px; font-size: 12px; border: 1px solid var(--border); border-radius: 6px; font-family: monospace; }
        input, select { background: var(--panel); border: 1px solid var(--border); color: white; padding: 12px; border-radius: 6px; width: 100%; margin-bottom: 10px; outline: none; box-sizing: border-box; }
        .btn { width: 100%; padding: 14px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; color: white; background: var(--green); margin-bottom: 10px; }
        
        /* BOT LISTESI */
        .bot-card { background: var(--panel); border: 1px solid var(--border); padding: 10px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
        .bot-card.selected { border-color: var(--blue); background: #1c2128; }
        .btn-sm { padding: 6px 12px; font-size: 11px; border-radius: 4px; margin: 0; }
        
        /* KONTROLLER */
        .control-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; max-width: 250px; margin: 10px auto; }
        .c-btn { background: #21262d; border: 1px solid var(--border); color: white; padding: 15px; border-radius: 8px; cursor: pointer; }
        .c-btn.active { background: var(--blue); color: black; }
        
        .inv-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 4px; }
        .slot { background: #21262d; border: 1px solid var(--border); aspect-ratio: 1; border-radius: 4px; display: flex; align-items: center; justify-content: center; position: relative; }
        .slot img { width: 80%; pointer-events: none; }
        .count { position: absolute; bottom: 1px; right: 2px; font-size: 10px; background: rgba(0,0,0,0.8); padding: 0 3px; }
    </style>
</head>
<body>

<nav>
    <button onclick="T('bot')" id="n-bot" class="active">BOTLAR</button>
    <button onclick="T('chat')" id="n-chat">CHAT/SPAM</button>
    <button onclick="T('ctrl')" id="n-ctrl">KONTROL</button>
</nav>

<div id="t-bot" class="tab active-tab">
    <input id="host" placeholder="Sunucu IP">
    <input id="user" placeholder="Bot ƒ∞smi">
    <select id="ver">
    <option value="1.21.6">1.21.6</option>
    <option value="1.21.4">1.21.4</option>
    <option value="1.21.1">1.21.1</option></select>
    <option value="1.20.4">1.20.4</option>
    <option value="1.20.1">1.20.1</option>
    <option value="1.19.4">1.19.4</option>
    <option value="1.19">1.19</option>
    <option value="1.18.4">1.18.4</option>
    <option value="1.18">1.18</option>
    <option value="1.17.4">1.17.4</option>
    <option value="1.17">1.17</option>
    <option value="1.16.5">1.16.5</option>
    <option value="1.12.2">1.12.2</option>
    <option value="1.8.9">1.8.9</option>
    <button class="btn" onclick="start()">BAƒûLAN</button>
    
    <div style="margin-top:20px; color: var(--blue); font-size: 12px; font-weight: bold;">AKTƒ∞F BOTLAR (KES BUTONLU)</div>
    <div id="blist"></div>
</div>

<div id="t-chat" class="tab">
    <div id="logbox"></div>
    <div style="display:flex; gap:5px; margin-top:5px;">
        <input id="mi" placeholder="Mesaj..." onkeydown="if(event.key==='Enter') send()" style="margin:0;">
        <button onclick="send()" style="background:var(--blue); border:none; color:white; border-radius:6px; width:50px;">‚û§</button>
    </div>
    
    <hr style="border:0; border-top:1px solid #30363d; margin:15px 0;">
    
    <div style="font-size:12px; color:var(--blue); font-weight:bold; margin-bottom:5px;">SPAM AYARLARI</div>
    <input id="spamMsg" placeholder="Spam mesajƒ±...">
    <div style="display:flex; gap:5px;">
        <input id="spamDelay" type="number" placeholder="S√ºre (ms)" value="2000">
        <button id="spamBtn" class="btn" style="background:#21262d; margin:0;" onclick="toggleSpam()">BA≈ûLAT</button>
    </div>
</div>

<div id="t-ctrl" class="tab">
    <div style="text-align:center; margin-bottom:10px;">
        <span id="hp" style="color:#ff7b72; font-weight:bold; font-size:18px;">‚ù§ --</span> 
        <span id="food" style="color:#d2a8ff; font-weight:bold; font-size:18px;">üçñ --</span>
        <div id="pos" style="color:#8b949e; font-size:12px; margin-top:5px;">üìç Konum Yok</div>
    </div>
    
    <div class="control-grid">
        <div></div><button class="c-btn" id="btn-forward" onclick="move('forward')">W</button><div></div>
        <button class="c-btn" id="btn-left" onclick="move('left')">A</button><button class="c-btn" id="btn-back" onclick="move('back')">S</button><button class="c-btn" id="btn-right" onclick="move('right')">D</button>
        <button class="c-btn" id="btn-jump" onclick="move('jump')">ZIP</button>
        <button class="c-btn" id="btn-sneak" onclick="move('sneak')">Eƒûƒ∞L</button>
    </div>
    
    <div style="display:flex; gap:5px; margin-bottom:15px;">
        <input id="cx" type="number" placeholder="X" style="text-align:center; margin:0;">
        <input id="cy" type="number" placeholder="Y" style="text-align:center; margin:0;">
        <input id="cz" type="number" placeholder="Z" style="text-align:center; margin:0;">
        <button class="btn" style="background:var(--blue); width:80px; margin:0; font-size:12px;" onclick="goTo()">Gƒ∞T</button>
    </div>

    <div style="font-size:12px; color:#8b949e; margin-bottom:5px;">ENVANTER</div>
    <div class="inv-grid" id="inv"></div>
</div>

<script>
    let sid = localStorage.getItem('sid') || 's_'+Date.now(); localStorage.setItem('sid', sid);
    let sel = "";
    let controls = { forward: false, back: false, left: false, right: false, jump: false, sneak: false };
    let isSpamming = false;

    function T(t){
        document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active-tab'));
        document.querySelectorAll('nav button').forEach(x=>x.classList.remove('active'));
        document.getElementById('t-'+t).classList.add('active-tab');
        document.getElementById('n-'+t).classList.add('active');
    }

    function start(){
        const h=document.getElementById('host').value, u=document.getElementById('user').value, v=document.getElementById('ver').value;
        if(h&&u) { fetch(`/start?sid=${sid}&host=${h}&port=25565&user=${u}&ver=${v}&auto=true`); sel=u; T('chat'); }
    }

    function quitBot(target){
        if(confirm(target + " sunucudan atƒ±lsƒ±n mƒ±?")) {
            fetch(`/quit?sid=${sid}&user=${target}`);
            if(target === sel) sel = "";
        }
    }

    function send(){
        const i=document.getElementById('mi');
        if(i.value&&sel) { fetch(`/send?sid=${sid}&user=${sel}&msg=${encodeURIComponent(i.value)}`); i.value=""; }
    }

    function toggleSpam() {
        if(!sel) return;
        isSpamming = !isSpamming;
        const btn = document.getElementById('spamBtn');
        const msg = document.getElementById('spamMsg').value || "Spam";
        const delay = document.getElementById('spamDelay').value || 3000;
        
        if(isSpamming) { btn.innerText = "DUR"; btn.style.background = "#da3633"; fetch(`/spam?sid=${sid}&user=${sel}&state=true&msg=${encodeURIComponent(msg)}&delay=${delay}`); }
        else { btn.innerText = "BA≈ûLAT"; btn.style.background = "#21262d"; fetch(`/spam?sid=${sid}&user=${sel}&state=false`); }
    }

    function move(dir) {
        if(!sel) return;
        controls[dir] = !controls[dir];
        document.getElementById('btn-'+dir).classList.toggle('active');
        fetch(`/move?sid=${sid}&user=${sel}&dir=${dir}&state=${controls[dir]}`);
    }

    function goTo(){
        const x=document.getElementById('cx').value, y=document.getElementById('cy').value, z=document.getElementById('cz').value;
        if(x&&y&&z) {
             Object.keys(controls).forEach(k => { controls[k] = false; document.getElementById('btn-'+k)?.classList.remove('active'); });
             fetch(`/goto?sid=${sid}&user=${sel}&x=${x}&y=${y}&z=${z}`);
        }
    }

    setInterval(async ()=>{
        try {
            const r = await fetch(`/data?sid=${sid}&user=${sel}`);
            const d = await r.json();
            
            // Bot Listesi G√ºncelleme (KES Butonlu)
            document.getElementById('blist').innerHTML = d.active.map(n=>`
                <div class="bot-card ${sel==n?'selected':''}" onclick="sel='${n}'">
                    <span><b>${n}</b></span>
                    <button class="btn btn-sm" style="background:var(--red);" onclick="event.stopPropagation(); quitBot('${n}')">KES</button>
                </div>
            `).join('');

            if(sel && d.logs[sel]) {
                const lb = document.getElementById('logbox');
                const scroll = lb.scrollTop + lb.clientHeight >= lb.scrollHeight - 20;
                lb.innerHTML = d.logs[sel].join('');
                if(scroll) lb.scrollTop = lb.scrollHeight;

                if(d.botData){
                    const bd = d.botData;
                    document.getElementById('hp').innerText = `‚ù§ %${Math.round(bd.hp*5)}`;
                    document.getElementById('food').innerText = `üçñ ${Math.round(bd.food)}`;
                    if(bd.pos) document.getElementById('pos').innerText = `üìç ${bd.pos.x}, ${bd.pos.y}, ${bd.pos.z}`;
                    document.getElementById('inv').innerHTML = bd.inv.map(i=>`<div class="slot" onclick="fetch('/drop?sid=${sid}&user=${sel}&slot=${i.slot}')"><img src="https://raw.githubusercontent.com/PrismarineJS/minecraft-assets/master/data/1.16.1/items/${i.name}.png"><span class="count">${i.count}</span></div>`).join('');
                }
            }
        } catch(e){}
    }, 1000);
</script>
</body>
</html>

